<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Just a simple function that makes a list-based data structure
that makes it easy to gene-drop chromosome segments down the
gsp.  The basic idea is to get everyone into a data structure
in which they are ordered such that by the time you get to segregating
segments from anyone, you already have the segments segregated into them.
This works by each individual having a list of gametes (post-recombination)
coming out of them, and a list of "uniters" which are the gametes coming
into them.  We just point the uniters to gametes in the previous generation
and then make sure that we shuffle the order of the gametes when they come
out of someone.'><title>Take a gsp in tibble form and make a list suitable for gene dropping — prep_gsp_for_hap_dropping • gscramble</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Take a gsp in tibble form and make a list suitable for gene dropping — prep_gsp_for_hap_dropping"><meta property="og:description" content='Just a simple function that makes a list-based data structure
that makes it easy to gene-drop chromosome segments down the
gsp.  The basic idea is to get everyone into a data structure
in which they are ordered such that by the time you get to segregating
segments from anyone, you already have the segments segregated into them.
This works by each individual having a list of gametes (post-recombination)
coming out of them, and a list of "uniters" which are the gametes coming
into them.  We just point the uniters to gametes in the previous generation
and then make sure that we shuffle the order of the gametes when they come
out of someone.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gscramble</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/about-createGSP.html">Pedigrees Available from create_GSP()</a>
    <a class="dropdown-item" href="../articles/gscramble-tutorial.html">A first tutorial for `gscramble`</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Take a gsp in tibble form and make a list suitable for gene dropping</h1>
      
      <div class="d-none name"><code>prep_gsp_for_hap_dropping.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Just a simple function that makes a list-based data structure
that makes it easy to gene-drop chromosome segments down the
gsp.  The basic idea is to get everyone into a data structure
in which they are ordered such that by the time you get to segregating
segments <em>from</em> anyone, you already have the segments segregated <em>into</em> them.
This works by each individual having a list of gametes (post-recombination)
coming out of them, and a list of "uniters" which are the gametes coming
into them.  We just point the uniters to gametes in the previous generation
and then make sure that we shuffle the order of the gametes when they come
out of someone.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">prep_gsp_for_hap_dropping</span><span class="op">(</span><span class="va">gsp</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>gsp</dt>
<dd><p>A tibble that holds the genome simulation pedigree (GSP).
This is a tibble in which each row specifies an individual in the
GSP.  The columns of the tibble are:</p><ul><li><p><code>ind</code>: a numeric identifier for that row's indvidual.</p></li>
<li><p><code>par</code>: the numeric ID of the first parent of the individual (NA if the
individual is a founder of the pedigree).</p></li>
<li><p><code>par2</code>: the numeric ID of the second parent of the individual (NA if
the individual is a founder)</p></li>
<li><p><code>ipar1</code>: the number of gametes that <code>par1</code> must segregate "through" <code>ind</code> in
order to exhaust all the genetic material in the GSP.  These values are given
by the red numerals alongside the edge connecting parents to offspring in the
GSP images defined by <code><a href="gsp2dot.html">gsp2dot()</a></code>.  See the vignette <code>gscramble-tutorial</code>, for
an example. (NA if <code>ind</code> is a founder).</p></li>
<li><p><code>ipar2</code>: the number of gametes that <code>par2</code> must segregate through <code>ind</code>.
(NA if <code>ind</code> is a founder).</p></li>
<li><p><code>hap1</code>: a unique character label given to the first haplotype in <code>ind</code> if <code>ind</code> is a
founder.  If <code>ind</code> is not a founder, this must be NA.</p></li>
<li><p><code>hap2</code>: unique character label given to the second haplotype in <code>ind</code>. NA if <code>ind</code>
is not a founder.</p></li>
<li><p><code>hpop1</code>: character label giving the population of origin of the first haplotype
(i.e., <code>hap1</code>) in <code>ind</code>, if <code>ind</code> is a founder.  NA otherwise.</p></li>
<li><p><code>hpop2</code>: character label giving the population of origin of the second
haplotype (i.e., <code>hap2</code>) in <code>ind</code>.  NA if <code>ind</code> is not a founder.</p></li>
<li><p><code>sample</code>: unique character label for the outcoming diploid sample from the
pedigree member <code>ind</code>. NA if <code>ind</code> is not sampled.</p></li>
<li><p><code>osample</code>: the number of diploid samples that come out of <code>ind</code>.  NA if
<code>ind</code> is not sampled.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>This function returns a named list, which is a linked-list type of
structure that contains the same information that is in <code>gsp</code>, but
it makes it easier to access when traversing the pedigree.</p>


<p>The length of the list is
<code>nrow(gsp)</code>. The names are the character versions of the <code>ind</code> column.
Each component of the list refers to an individual row from <code>gsp</code>.  All
of these list elements are themselves lists. (i.e., the information
about a single individual is stored in a list.) Every such individual
list has at least the two elements:</p><ul><li><p><code>isSample</code>: TRUE if samples are taken from the individual. FALSE otherwise.</p></li>
<li><p><code>isFounder</code>: TRUE if the individual is a founder.  FALSE otherwise.</p></li>
<li><p><code>nGamete</code>: The total number of gametes that will be segregated <em>out</em>
of this individual along edges to the <em>offspring</em> of the individual in the pedigree.
This is the sum of all the red numbers alongside edges below the individual in the
GSP.</p></li>
</ul><p>If an individual's <code>isSample</code> is TRUE, then its list also contains the following elements:</p><ul><li><p><code>nSamples</code>: the number of diploid genomes sampled out of this individual.
This is the purple number along the edge to the sample node below the individual
in the GSP "picture".</p></li>
</ul><p>If an individual's, <code>isFounder</code> is TRUE then its list also contains
the following elements:</p><ul><li><p><code>hpop1</code>: the population from which haplotype 1 in this (founder) individual originated.</p></li>
<li><p><code>hpop2</code>: the population from which haplotype 2 in this (founder) individual originated.</p></li>
<li><p><code>fh_idx1</code>: this stands for "founding haplotype index 1.  It is a unique integer
that identifies haplotype one in this founder individual.  This integer is unique over
all haplotypes in all the founder individuals.</p></li>
<li><p><code>fh_idx2</code>' the unique integer identifier for haplotype two in this founder
individual.</p></li>
</ul><p>If an individual's <code>isFounder</code> is FALSE, then its list also contains
the following elements:</p><ul><li><p><code>par1</code> and <code>par2</code>. Each of these is a list with the elements:</p><ul><li><p><code>par</code>: the character identifier of the first (if in <code>par1</code>) of the
second (if in <code>par2</code>) parent of the individual.</p></li>
<li><p><code>gam_idx</code>: This tells us which of the gametes in the parent (1 or 2)
depending on if this is in <code>par1</code> or <code>par2</code>, gets segregated to the
individual.  NEED TO EXPLAIN MORE.  SINCE THINGS GET PERMUTED, ETC.</p></li>
</ul></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># get the 13 member complex pedigree in tibble form as the</span></span>
<span class="r-in"><span class="co"># package data object GSP and prep it:</span></span>
<span class="r-in"><span class="va">GSP_list</span> <span class="op">&lt;-</span> <span class="fu">prep_gsp_for_hap_dropping</span><span class="op">(</span><span class="va">GSP</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

